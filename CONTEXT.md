# FortiGate 60F - FIPS-CC + CMMC Level 2 Configuration Context

## Device Information
- **Model:** FortiGate 60F
- **Serial Number:** FGT60FTK24031122
- **Current Version:** FortiOS 7.4.9 build2829 (GA.M)
- **Security Level:** High
- **FIPS-CC Mode:** Enabled (IRREVERSIBLE - cannot be disabled without factory reset)
- **Operation Mode:** NAT
- **Hostname:** CBS-FORTI

## Current Network Configuration

### WAN Interface (Production)
- **wan1:** Physical interface, trunk mode for VLAN 847
- **wan1.847:** Production WAN VLAN
  - IP: 204.186.251.250/30
  - Gateway: 204.186.251.249
  - VLAN ID: 847
  - **Status:** UP (1000Mbps full duplex)
  - **MAC Address:** 48:3a:02:57:b5:b8
- **Note:** Fiber ISP connection active and operational

### Internal VLAN Interfaces
All VLANs are on the "internal" hardware switch (physical ports internal1-5):

1. **internal1.3** - IoT Guest Network
   - IP: 172.16.3.1/24
   - VLAN ID: 3
   - DHCP Pool: 172.16.3.100-200
   - DNS: 1.1.1.1, 8.8.8.8

2. **internal1.4** - CORP-LAN (Corporate Network)
   - IP: 172.16.4.1/24
   - VLAN ID: 4
   - DHCP Pool: 172.16.4.100-200
   - DNS: 1.1.1.1, 8.8.8.8
   - **Status:** ACTIVE - Subnet conflict resolved with production WAN

3. **internal1.5** - Studio-LAN
   - IP: 172.16.5.1/24
   - VLAN ID: 5
   - DHCP Pool: 172.16.5.100-200
   - DNS: 1.1.1.1, 8.8.8.8

4. **internal1.6** - Guest Network
   - IP: 172.16.6.1/24
   - VLAN ID: 6
   - DHCP Pool: 172.16.6.100-200
   - DNS: 1.1.1.1, 8.8.8.8

### Management Interface
- **dmz:** 192.168.99.1/24
- DHCP Pool: 192.168.99.100-110
- DNS: 1.1.1.1, 8.8.8.8
- Purpose: Management access and testing
- **Status:** DOWN (not currently in use)

### Internal Hardware Switch
- **Interface:** internal (ports internal1-5)
- **Status:** UP
- **Connected Port:** internal5 (trunk to UniFi switch)
- **VLANs Trunked:** 3, 4, 5, 6

## Firewall Policies

### Default FIPS-CC Security Policies (1-6)
Auto-generated by FIPS-CC mode to block bogon traffic:
- Policy 1-6: Block Class-E, Local-Link, non-global IPv6 traffic

### User-Created Policies

**Policy 11:** Management to Internet
- Source: dmz (192.168.99.0/24)
- Destination: wan1.847
- Action: Accept
- NAT: Enabled
- Logging: All traffic

**Policy 12:** Studio-LAN to Internet
- Source: internal1.5 (172.16.5.0/24)
- Destination: wan1.847
- Action: Accept
- NAT: Enabled
- Logging: All traffic

**Policy 13:** IoT to Internet
- Source: internal1.3 (172.16.3.0/24)
- Destination: wan1.847
- Action: Accept
- NAT: Enabled
- Logging: All traffic (isolated from other VLANs)

**Policy 14:** Guest to Internet
- Source: internal1.6 (172.16.6.0/24)
- Destination: wan1.847
- Action: Accept
- NAT: Enabled
- Logging: All traffic (isolated from other VLANs)

**Policy 15:** CORP-LAN to Internet
- Source: internal1.4 (172.16.4.0/24)
- Destination: wan1.847
- Action: Accept
- NAT: Enabled
- Logging: All traffic
- Comments: CMMC L2: Corporate network

**Policy 16:** Allow ICMP to ISP Network
- Source: internal1.4, internal1.3, internal1.5, internal1.6, dmz
- Destination: ISP-Network-204.186.63.0 (204.186.63.0/26)
- Service: PING
- Action: Accept
- NAT: Enabled
- Comments: Allow ICMP to ISP monitoring network

**Note:** No inter-VLAN traffic is permitted (CMMC segmentation requirement)

## CMMC Level 2 Compliance Settings

### Access Control (NIST 800-171: 3.1.x, 3.5.x)
- **Admin Timeout:** 15 minutes
- **Console Timeout:** 300 seconds (5 minutes)
- **Account Lockout:** 3 failed attempts
- **Lockout Duration:** 300 seconds (5 minutes)
- **Login Banners:** Pre-login and post-login enabled
- **Multi-Factor Authentication:** Optional (can be made required)

### Password Policy (NIST 800-171: 3.5.7)
- **Minimum Length:** 15 characters
- **Complexity Required:**
  - Minimum 1 lowercase letter
  - Minimum 1 uppercase letter
  - Minimum 1 number
  - Minimum 1 special character
- **Password Expiry:** 90 days
- **Password Reuse:** Disabled

### Cryptographic Protection (NIST 800-171: 3.13.11)
- **FIPS-CC Mode:** Enabled (FIPS 140-2 validated cryptography)
- **TLS Minimum Version:** TLS 1.2
- **SSH:** Version 2 only (v1 disabled)
- **Telnet:** Disabled
- **HTTPS Redirect:** Enabled for admin access

### Audit and Accountability (NIST 800-171: 3.3.x)
- **CLI Audit Log:** Enabled
- **SSL Connection Logging:** Enabled
- **Firewall Traffic Logging:** All policies log traffic
- **âš ï¸ TODO:** Configure centralized syslog/FortiAnalyzer

## Physical Connections

### Production Setup (ACTIVE)
```
[Fiber ISP] â”€â”€â”€â”€â”€ wan1 port â”€â”€â”€â”€â”€ wan1.847 (VLAN 847: 204.186.251.250/30)
                                   Status: UP, 1000Mbps Full Duplex

[UniFi Switch] â”€â”€ internal5 port â”€â”€ internal hard-switch (VLANs 3,4,5,6)
                                     Status: UP, Trunk Mode
```

**Connection Details:**
- WAN: Fiber connected to wan1 physical port
- LAN: UniFi switch trunk cable connected to internal5
- All VLANs operational and routing through wan1.847

## VPN Configuration (In Progress)

### IPsec VPN with Azure AD SAML
**Status:** ðŸ”„ IN PROGRESS (~70% complete)
**Type:** IPsec IKEv2 Dial-Up VPN
**Authentication:** Azure AD SAML + MFA
**Documentation:** See VPN-SETUP-STATUS.md for detailed status

**VPN Network:**
- IP Pool: 10.255.1.10-250
- DNS: 1.1.1.1, 8.8.8.8
- Access Model: Full tunnel - Internet only (no internal network access)

**Azure AD Integration:**
- Enterprise Application: FortiGate IPsec VPN SAML
- SAML Server: AzureAD-VPN
- User Group: VPN-Users-Azure
- Conditional Access: MFA enforced
- Group Object ID: c300028f-7819-4225-b334-76695b85aaaa

**VPN Configuration:**
- Phase 1 Interface: Azure-VPN-IKEv2
  - Interface: wan1.847
  - IKE Version: 2
  - Encryption: AES256-SHA384
  - DH Group: 15 (3072-bit)
  - Mode Config: Enabled
- Phase 2 Interface: Azure-VPN-IKEv2
  - Encryption: AES256-SHA256
  - DH Group: 15 with PFS
  - Replay Detection: Enabled

**Current Issue:**
- âš ï¸ IKEv2 configuration showing "-1: Invalid length of value" error
- Investigating PSK/authentication requirements for IKEv2 with SAML
- Configuration paused pending resolution

**Pending Tasks:**
- Resolve IKEv2 configuration error
- Create firewall policies (block VPN to internal, allow VPN to Internet)
- Configure FortiClient
- Test VPN connection with MFA

## Deployment Status

### âœ… Completed Items
1. **Production WAN Migration** - December 11, 2025
   - wan1.847 configured and operational
   - Fiber ISP connection active
   - Internet connectivity verified from all VLANs
   - Default route via 204.186.251.249

2. **Internal Network Activation**
   - All 4 VLANs (3, 4, 5, 6) operational
   - DHCP serving addresses on all networks
   - VLAN isolation confirmed (CMMC requirement)
   - UniFi switch trunk connected and working

3. **Firewall Policies**
   - All policies updated to use wan1.847
   - NAT operational on all policies
   - Traffic logging enabled
   - ICMP policy for ISP monitoring added

### âš ï¸ Items to Address

1. **ISP Monitoring**
   - ISP unable to ping WAN IP (204.186.251.250) from monitoring network
   - ICMP policy created but inbound ping not responding
   - May require additional troubleshooting or ISP-side configuration

2. **Management Access**
   - DMZ port available but not currently in use
   - Primary management via CORP-LAN (172.16.4.1)
   - Consider future DMZ use case or repurpose

## Migration from SonicWall

### Original SonicWall Configuration
- **X0:** 192.168.168.168/24 - Default LAN (Not migrated)
- **X0:V3:** 172.16.3.1/24 - IoT Guest Network âœ… (Migrated & Active)
- **X0:V4:** 172.16.4.1/24 - CORP-LAN âœ… (Migrated & Active)
- **X0:V5:** 172.16.5.1/24 - Studio-LAN âœ… (Migrated & Active)
- **X0:V6:** 172.16.6.1/24 - Guest Network âœ… (Migrated & Active)
- **X1:V847:** 204.186.251.250/30 - WAN VLAN 847 âœ… (Migrated & Active)
- **X1:V1449:** 204.186.249.142/29 - VLAN 1449 (Not yet migrated)

### Migration Status
- **Date Completed:** December 11, 2025
- **Status:** Production operational
- **SonicWall:** Decommissioned/standby
- **UniFi Switching:** Connected to FortiGate internal5, all VLANs trunked

## Access Information

### GUI Access
- **Production Access:** https://172.16.4.1 (CORP-LAN) - PRIMARY
- **Alternate Access:** https://192.168.99.1 (via DMZ port) - Currently inactive

### Admin Credentials
- **Username:** admin
- **Password:** (15+ character password set during FIPS-CC setup)
- **Note:** Password meets CMMC Level 2 requirements

### Console Access
- **Port:** USB-C console port
- **Settings:** 9600 baud, 8N1
- **Default Login:** admin / (password above)

## Important Notes

### FIPS-CC Mode
âš ï¸ **CRITICAL:** FIPS-CC mode is **IRREVERSIBLE**. Once enabled, it cannot be disabled without performing a factory reset, which will erase all configuration.

### CMMC Compliance Status
âœ… **Ready for C3PAO Assessment** with the following caveats:
- Need to configure centralized logging (syslog/FortiAnalyzer)
- Should create individual admin accounts (no shared admin)
- Consider enabling MFA for admin access
- Document system security plan
- Implement regular configuration backups

## Configuration Backup
**Status:** Production configuration active - backup recommended

**Backup Command:**
```bash
execute backup config management-station "post-migration-backup-20251211"
```

Or via GUI: **System > Configuration > Backup**

**Recommended Schedule:** Weekly backups or after any configuration changes

## Support Resources
- **Fortinet Support:** https://support.fortinet.com
- **Serial Number for Support:** FGT60FTK24031122
- **Documentation:** FortiOS 7.4.9 Administration Guide
- **CMMC Resources:** https://www.acq.osd.mil/cmmc/

## Firewall Address Objects

**ISP-Network-204.186.63.0:**
- Subnet: 204.186.63.0/26 (255.255.255.192)
- Purpose: ISP monitoring network
- Used in: Policy 16 (ICMP to ISP)

---
*Configuration completed: November 2025*
*Production deployment: December 11, 2025*
*FIPS-CC Mode: Enabled*
*CMMC Level 2: Compliant (pending centralized logging, individual admin accounts, MFA)*
*Migration Status: COMPLETE - All VLANs operational*
